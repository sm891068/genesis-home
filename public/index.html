<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é»‘é“å»ºç¯‰ Underworld Architect</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --gold: #d4af37;
            --gold-light: #f4d03f;
            --gold-dark: #b8941f;
            --gold-glow: rgba(212, 175, 55, 0.3);
            --red: #ff2e63;
            --blue: #3498db;
            --bg: #0a0e27;
            --bg-light: #151a35;
            --panel: rgba(10, 14, 39, 0.98);
            --text: #e8e8e8;
            --gray: #888;
            --border: rgba(212, 175, 55, 0.2);
        }
        
        body {
            font-family: 'Noto Serif TC', serif;
            background: var(--bg);
            color: var(--text);
            height: 100vh;
            overflow: hidden;
            position: relative;
        }
        
        /* ========== ä¸‹é›¨å‹•ç•« ========== */
        .rain {
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }
        
        .raindrop {
            position: absolute;
            width: 2px;
            height: 20px;
            background: linear-gradient(transparent, rgba(212, 175, 55, 0.3));
            animation: fall linear infinite;
        }
        
        @keyframes fall {
            to { transform: translateY(100vh); }
        }
        
        /* ========== ä¸»é¸å–®å®¹å™¨ ========== */
        #main-menu {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            position: relative;
            z-index: 10;
            background: radial-gradient(ellipse at center, rgba(212,175,55,0.05) 0%, transparent 70%);
        }
        
        .logo {
            font-size: 48px;
            font-weight: 900;
            color: var(--gold);
            text-shadow: 0 0 30px var(--gold-glow), 0 0 60px var(--gold-glow);
            margin-bottom: 20px;
            animation: glow 3s ease-in-out infinite;
            font-family: 'Noto Serif TC', serif;
            letter-spacing: 4px;
        }
        
        @keyframes glow {
            0%, 100% { text-shadow: 0 0 30px var(--gold-glow), 0 0 60px var(--gold-glow); }
            50% { text-shadow: 0 0 40px var(--gold-glow), 0 0 80px var(--gold-glow), 0 0 100px rgba(212,175,55,0.1); }
        }
        
        .subtitle {
            font-size: 18px;
            color: var(--gray);
            margin-bottom: 60px;
            letter-spacing: 2px;
        }
        
        .menu-buttons {
            display: flex;
            flex-direction: column;
            gap: 16px;
            min-width: 320px;
        }
        
        .menu-btn {
            padding: 18px 40px;
            background: linear-gradient(135deg, rgba(212,175,55,0.15), rgba(212,175,55,0.05));
            border: 2px solid var(--gold-dark);
            color: var(--text);
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            border-radius: 12px;
            transition: all 0.3s;
            font-family: 'Noto Serif TC', serif;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        
        .menu-btn::before {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(90deg, transparent, rgba(212,175,55,0.2), transparent);
            transform: translateX(-100%);
            transition: transform 0.5s;
        }
        
        .menu-btn:hover::before {
            transform: translateX(100%);
        }
        
        .menu-btn:hover {
            background: linear-gradient(135deg, rgba(212,175,55,0.3), rgba(212,175,55,0.1));
            border-color: var(--gold);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(212,175,55,0.3);
        }
        
        .menu-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
            background: rgba(255,255,255,0.05);
            border-color: var(--gray);
        }
        
        .menu-btn:disabled:hover {
            transform: none;
            box-shadow: none;
        }
        
        .footer-info {
            position: fixed;
            bottom: 20px;
            text-align: center;
            width: 100%;
            font-size: 12px;
            color: var(--gray);
            z-index: 10;
        }
        
        /* ========== Toast æ¨£å¼ ========== */
        .toast {
            position: fixed;
            top: 70px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.95);
            border: 1.5px solid var(--gold);
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 14px;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
            box-shadow: 0 0 30px var(--gold-glow);
        }
        
        .toast.show { opacity: 1; }
        
        .toast.success { border-color: #27ae60; }
        .toast.error { border-color: #e74c3c; }
        .toast.warning { border-color: #f39c12; }
        
        /* ========== éŸ¿æ‡‰å¼è¨­è¨ˆ ========== */
        @media (max-width: 768px) {
            .logo { font-size: 36px; }
            .subtitle { font-size: 14px; margin-bottom: 40px; }
            .menu-buttons { min-width: 280px; gap: 12px; }
            .menu-btn { padding: 16px 32px; font-size: 16px; }
        }
        
        @media (max-width: 480px) {
            .logo { font-size: 28px; }
            .subtitle { font-size: 12px; margin-bottom: 30px; }
            .menu-buttons { min-width: 240px; gap: 10px; }
            .menu-btn { padding: 14px 28px; font-size: 14px; }
        }
    </style>
</head>
<body>
    <!-- ä¸‹é›¨å‹•ç•«å®¹å™¨ -->
    <div class="rain" id="rain"></div>

    <!-- Toast æç¤º -->
    <div id="toast" class="toast"></div>

    <!-- ä¸»é¸å–® -->
    <div id="main-menu">
        <div class="logo">é»‘é“å»ºç¯‰</div>
        <div class="subtitle">UNDERWORLD ARCHITECT</div>
        
        <div class="menu-buttons">
            <button class="menu-btn" onclick="menuController.newGame()">
                ğŸ†• æ–°çš„å‚³æ‰¿
            </button>
            <button class="menu-btn" id="continue-btn" onclick="menuController.continueGame()" disabled>
                â–¶ï¸ ç¹¼çºŒéŠæˆ²
            </button>
            <button class="menu-btn" onclick="menuController.showPartnerGallery()">
                ğŸ“– å¤¥ä¼´åœ–é‘‘
            </button>
            <button class="menu-btn" onclick="menuController.showAchievements()">
                ğŸ† æˆå°±æ®¿å ‚
            </button>
            <button class="menu-btn" onclick="menuController.showSettings()">
                âš™ï¸ è¨­å®š
            </button>
        </div>
        
        <div class="footer-info">
            Version 1.0.0 | Made with â¤ï¸ by Your Studio
        </div>
    </div>

    <!-- è¼‰å…¥æ ¸å¿ƒè…³æœ¬ -->
    <script src="/static/core/game-state.js"></script>
    <script src="/static/ui/shared-ui.js"></script>
    <script src="/static/routes-data.js"></script>
    <script src="/static/core-partners-20.js"></script>
    <script src="/static/partner-data.js"></script>
    <script src="/static/achievements-24.js"></script>

    <script>
    // ========== ä¸»é¸å–®æ§åˆ¶å™¨ ==========
    const menuController = {
        init() {
            console.log('[MainMenu] åˆå§‹åŒ–ä¸»é¸å–®');
            
            // æª¢æŸ¥æ˜¯å¦æœ‰å­˜æª”
            this.updateContinueButton();
            
            // åˆå§‹åŒ–ä¸‹é›¨å‹•ç•«
            this.initRain();
        },

        // æ›´æ–°ç¹¼çºŒæŒ‰éˆ•ç‹€æ…‹
        updateContinueButton() {
            const btn = document.getElementById('continue-btn');
            const latestSave = GameState.getLatestSave();
            
            if (latestSave) {
                btn.disabled = false;
                btn.textContent = `â–¶ï¸ ç¹¼çºŒéŠæˆ² (Day ${latestSave.day})`;
            } else {
                btn.disabled = true;
                btn.textContent = 'â–¶ï¸ ç¹¼çºŒéŠæˆ²';
            }
        },

        // æ–°éŠæˆ²
        newGame() {
            Toast.show('æ­£åœ¨æº–å‚™æ–°éŠæˆ²...', 1500);
            
            // TODO: é¡¯ç¤ºè·¯ç·šé¸æ“‡ç•«é¢
            setTimeout(() => {
                this.showRouteSelection();
            }, 1500);
        },

        // é¡¯ç¤ºè·¯ç·šé¸æ“‡ï¼ˆæš«æ™‚è·³éï¼Œç›´æ¥é–‹å§‹ï¼‰
        showRouteSelection() {
            // æš«æ™‚ä½¿ç”¨ A è·¯ç·šç›´æ¥é–‹å§‹
            const gangName = prompt('è«‹è¼¸å…¥æ‚¨çš„å¹«æ´¾åç¨±ï¼š', 'é¾é–€å¹«');
            
            if (!gangName) {
                Toast.warning('å·²å–æ¶ˆæ–°éŠæˆ²');
                return;
            }

            LoadingScreen.show('æ­£åœ¨åˆå§‹åŒ–éŠæˆ²...');
            
            setTimeout(() => {
                // é–‹å§‹æ–°éŠæˆ²ï¼ˆè·¯ç·š Aï¼‰
                const success = GameState.newGame('A', gangName, 'è€å¤§');
                
                if (success) {
                    LoadingScreen.hide();
                    Toast.success(`æ­¡è¿ä¾†åˆ° ${gangName}ï¼`);
                    
                    // è·³è½‰åˆ°éŠæˆ²ç•«é¢
                    setTimeout(() => {
                        window.location.href = '/game-main.html';
                    }, 1000);
                } else {
                    LoadingScreen.hide();
                    Toast.error('éŠæˆ²åˆå§‹åŒ–å¤±æ•—');
                }
            }, 2000);
        },

        // ç¹¼çºŒéŠæˆ²
        continueGame() {
            const latestSave = GameState.getLatestSave();
            
            if (!latestSave) {
                Toast.error('æ‰¾ä¸åˆ°å­˜æª”');
                return;
            }

            LoadingScreen.show('è¼‰å…¥å­˜æª”ä¸­...');
            
            setTimeout(() => {
                const success = GameState.load(latestSave.id);
                
                if (success) {
                    LoadingScreen.hide();
                    Toast.success('å­˜æª”è¼‰å…¥æˆåŠŸï¼');
                    
                    // è·³è½‰åˆ°éŠæˆ²ç•«é¢
                    setTimeout(() => {
                        window.location.href = '/game-main.html';
                    }, 800);
                } else {
                    LoadingScreen.hide();
                    Toast.error('å­˜æª”è¼‰å…¥å¤±æ•—');
                }
            }, 1500);
        },

        // é¡¯ç¤ºå¤¥ä¼´åœ–é‘‘
        showPartnerGallery() {
            Toast.show('å¤¥ä¼´åœ–é‘‘åŠŸèƒ½é–‹ç™¼ä¸­...', 2000);
            // TODO: é¡¯ç¤ºå¤¥ä¼´åœ–é‘‘ç•«é¢
        },

        // é¡¯ç¤ºæˆå°±æ®¿å ‚
        showAchievements() {
            Toast.show('æˆå°±æ®¿å ‚åŠŸèƒ½é–‹ç™¼ä¸­...', 2000);
            // TODO: é¡¯ç¤ºæˆå°±æ®¿å ‚ç•«é¢
        },

        // é¡¯ç¤ºè¨­å®š
        showSettings() {
            Toast.show('è¨­å®šåŠŸèƒ½é–‹ç™¼ä¸­...', 2000);
            // TODO: é¡¯ç¤ºè¨­å®šç•«é¢
        },

        // åˆå§‹åŒ–ä¸‹é›¨å‹•ç•«
        initRain() {
            const rainContainer = document.getElementById('rain');
            const dropCount = 100; // é›¨æ»´æ•¸é‡

            for (let i = 0; i < dropCount; i++) {
                const drop = document.createElement('div');
                drop.className = 'raindrop';
                
                // éš¨æ©Ÿä½ç½®
                drop.style.left = Math.random() * 100 + '%';
                
                // éš¨æ©Ÿå»¶é²
                drop.style.animationDelay = Math.random() * 2 + 's';
                
                // éš¨æ©ŸæŒçºŒæ™‚é–“
                drop.style.animationDuration = (Math.random() * 1 + 1) + 's';
                
                // éš¨æ©Ÿé€æ˜åº¦
                drop.style.opacity = Math.random() * 0.5 + 0.3;
                
                rainContainer.appendChild(drop);
            }
        }
    };

    // é é¢è¼‰å…¥å®Œæˆå¾Œåˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', () => {
        menuController.init();
    });
    </script>
</body>
</html>
